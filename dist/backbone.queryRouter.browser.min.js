!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,e,f){b=b||"&",e=e||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(e);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),c(g,n)?d(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var d=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],2:[function(a,b){"use strict";function c(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var d=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,g,h){return b=b||"&",g=g||"=",null===a&&(a=void 0),"object"==typeof a?c(f(a),function(c){var f=encodeURIComponent(d(c))+g;return e(a[c])?a[c].map(function(a){return f+encodeURIComponent(d(a))}).join(b):f+encodeURIComponent(d(a[c]))}).join(b):h?encodeURIComponent(d(h))+g+encodeURIComponent(d(a)):""};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},f=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],3:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":1,"./encode":2}],4:[function(a){"use strict";var b=window&&window.Backbone||a("backbone"),c=window&&window._||a("underscore"),d=a("querystring"),e=b.History.extend({constructor:function(){this.previousQuery={},this.queryHandlers=[],this.listenTo(this.query,"change",this.onQueryModelChange),this.query.toString=function(){return d.stringify(this.attributes)},b.History.call(this)},queryMatcher:/^([^?]*?)(?:\?([\s\S]*))?$/,query:new b.Model,getBaseRoute:function(){return this._stripQuery(b.history.fragment)},loadQuery:function(a){a||(a=this.fragment),this._syncQueryModelFromFragment(a);var b=this.query.toJSON(),d=this.previousQuery;this.previousQuery=b;var e=this._getDiffs(d,b);e.length&&c.each(this.queryHandlers,function(d){var f=c.intersection(e,d.bindings);f.length&&d.callback(a,b,f)})},loadUrl:function(a){return this._previousBaseFragment!==this._stripQuery(a)?b.History.prototype.loadUrl.apply(this,arguments):!0},navigate:function(a,c){if(!b.History.started)return!1;c&&c!==!0||(c={trigger:!!c}),this._previousBaseFragment=this._stripQuery(this.fragment);var d=b.History.prototype.navigate.call(this,a,c);return this._syncQueryModelFromFragment(this.fragment,{silent:!(c&&c.trigger)}),c.trigger&&this.loadQuery(a,c),d},navigateBase:function(a,c){var d=this._fragmentToQueryString(b.history.fragment);return this.navigate(this._stripQuery(a)+"?"+d,c)},onQueryModelChange:function(){var a=this._stripQuery(this.fragment||"");this.navigate(a+"?"+this.query.toString(),{trigger:!0})},queryHandler:function(a,b){this.queryHandlers.push({bindings:a,callback:b})},resetQuery:function(a,b){c.isString(a)&&(-1===a.indexOf("?")&&(a="?"+a),a=this._fragmentToQueryObject(a)),b||(b={});var d=this.query;d._changing=!0,b.unset!==!1&&c.each(d.attributes,function(b,c){a[c]||d.unset(c)}),b.set!==!1&&c.each(a,function(a,b){d.set(b,a)}),d._changing=!1,b.silent||c.isEmpty(d.changed)||d.trigger("change",d,b)},start:function(){var a=b.History.prototype.start.apply(this,arguments);return this.options.silent||this.loadQuery(),a},_getDiffs:function(a,b){return c.chain(a).keys().concat(c.keys(b)).reduce(function(d,e){return c.result(a[e],"toString")!==c.result(b[e],"toString")&&d.push(e),d},[]).uniq().value()},_fragmentToQueryObject:function(a){try{return d.parse(this._fragmentToQueryString(a))}catch(b){throw new Error("Unable to parse fragment into query object: "+a)}},_fragmentToQueryString:function(a){if(!a)return"";var b=a.match(this.queryMatcher);return b[2]||""},_syncQueryModelFromFragment:function(a,b){var c=this._fragmentToQueryObject(this.fragment);this.stopListening(this.query,"change",this.onQueryModelChange),this.resetQuery(c,b),this.listenTo(this.query,"change",this.onQueryModelChange)},_stripQuery:function(a){return a?a.split("?")[0]:""}}),f=b.Router.prototype,g=b.Router.extend({_bindRoutes:function(){if(this.queryRoutes){this.queryRoutes=c.result(this,"queryRoutes");for(var a,b=c.keys(this.queryRoutes);null!=(a=b.pop());)this.queryHandler(a,this.queryRoutes[a]);f._bindRoutes.apply(this,arguments)}},navigateBase:function(a,c){return b.history.navigateBase(a,c),this},queryHandler:function(a,d,e){if(a=this._normalizeBindings(a),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]),!e)throw new Error("QueryHandler not found: "+this[d]);var f=this;return b.history.queryHandler(a,function(a,c,g){f.execute(e,[c,g]),f.trigger("route:"+d,g,c),f.trigger("route",d,[c,g]),b.history.trigger("route",f,d,[c,g])}),this},_normalizeBindings:function(a){return c.isString(a)&&(a=a.split(",")),c.invoke(a,"trim")}});b.Router=g,b.history=new e},{backbone:!1,querystring:3,underscore:!1}]},{},[4]);